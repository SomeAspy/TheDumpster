<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Client, GatewayIntentBits, Events } from 'discord.js';
import { config } from 'dotenv';

config();

/** The bot client */
export const bot = new Client({
    intents: [
        GatewayIntentBits.Guilds,
        GatewayIntentBits.GuildMembers,
    ],
});

// Ready Event

bot.once(Events.ClientReady, () => {
    console.log(`[Info]: Connected To Discord!\n[Info]:\tGuild Count: ${bot.guilds.cache.size}\n[Info]:\tMy ID: ${bot.user?.id}`);
});

// DB Connection ***************************************************************

import { connectDB } from './db/mongo.js';
await connectDB();

// Slash Command Indexer ******************************************************

import { indexSlashCommands } from './indexer/slash.js';
await indexSlashCommands();

// Push Slash Commands To Discord *********************************************

import { getSetting } from './db/config.js';
import { pushCommands } from './lib/pushCommands.js';
if (await getSetting('PushCommands')) {
    await pushCommands();
}

// Interaction Handler ********************************************************

import { handleInteraction } from './events/interaction.js';

bot.on(Events.InteractionCreate, async interaction => {
    try {
        await handleInteraction(interaction, bot);
    } catch
    (error) {
        console.error(`[Interaction Handler]: ${error}`);
    }
});

import { handleMemberLeave } from './events/memberLeave.js';

bot.on(Events.GuildMemberRemove, async member => {
    try {
        await handleMemberLeave(member);
    } catch (error) {
        console.error(`[Guild Leave Handler]: ${error}`);
    }
});

// Guild Member Update ********************************************************

import { handleMemberUpdate } from './events/memberUpdate.js';

bot.on(Events.GuildMemberUpdate, async (oldMember, newMember) => {
    try {
        await handleMemberUpdate(oldMember, newMember);
    } catch (error) {
        console.error(`[Guild Update Handler]: ${error}`);
    }
});

// Other Events ***************************************************************

bot.on(Events.Error, (e) => console.error(`[Discord API]: ${e}`));
bot.on(Events.Warn, (e) => console.warn(`[Discord API]: ${e}`));
bot.on(Events.Invalidated, async () => {
    console.log('[Fatal]: Session invalidated! Goodbye!');
    await bot.db.close();
    bot.destroy();
    process.exit(1);
});

// Login **********************************************************************

bot.login(process.env.DISCORD_TOKEN);</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#bot">bot</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Sat Dec 24 2022 23:15:31 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
